<Window x:Class="SandBox.frmSelectSheetsFromLlist"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SandBox"       
        Title="Select Sheets" Height="600" Width="500"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="False">
    
    <DockPanel Margin="10">
        <!-- Top Section: Filter and Sheet Sets -->
        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
            <!-- Filter Icon and Search Box -->
            <DockPanel>
                <Button x:Name="FilterButton" 
                        Width="24" Height="24" 
                        Margin="0,0,10,0"
                        ToolTip="Filter sheets">
                    <Canvas Width="16" Height="16">
                        <Path Data="M3,2H21V2H21V4H20.92L14,10.92V22.91L10,18.91V10.92L3.09,4H3V2Z" 
                              Fill="Black" 
                              Stretch="Uniform"/>
                    </Canvas>
                </Button>
                <Grid>
                    <TextBox x:Name="SearchTextBox" 
                             Height="25"
                             Padding="5,0,24,0"
                             VerticalContentAlignment="Center"
                             TextChanged="SearchTextBox_TextChanged"/>
                    <Button x:Name="ClearSearchButton" 
                            Width="22" Height="22" 
                            Margin="0,0,2,0"
                            HorizontalAlignment="Right"
                            BorderThickness="0"
                            Background="White"
                            Visibility="Collapsed"
                            Click="ClearSearchButton_Click">
                        <Canvas Width="16" Height="16">
                            <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" 
                                  Fill="DimGray" 
                                  Stretch="Uniform"/>
                        </Canvas>
                    </Button>
                </Grid>
            </DockPanel>

            <!-- Sheet Sets Dropdown -->
            <DockPanel Margin="0,10,0,0">
                <TextBlock Text="Sheet Sets:" 
                           FontSize="14" 
                           Margin="0,3,10,0"
                           DockPanel.Dock="Left"
                           VerticalAlignment="Center"/>
                <ComboBox x:Name="SheetSetsComboBox" 
                          Height="25"
                          SelectionChanged="SheetSetsComboBox_SelectionChanged"/>
            </DockPanel>

            <!-- Increment Value Input -->
            <DockPanel Margin="0,10,0,0">
                <TextBlock Text="Increment Value:" 
                           FontSize="14" 
                           Margin="0,3,10,0"
                           DockPanel.Dock="Left"
                           VerticalAlignment="Center"/>
                <TextBox x:Name="IncrementValueTextBox" 
                         Width="60"
                         Height="25"
                         Text="1"
                         HorizontalAlignment="Left"
                         VerticalContentAlignment="Center"
                         TextAlignment="Center"/>
            </DockPanel>
        </StackPanel>

        <!-- Bottom Section: Action Buttons -->
        <StackPanel DockPanel.Dock="Bottom">
            <!-- Check/Uncheck/Toggle Buttons -->
            <Grid Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="CheckAllButton" 
                        Grid.Column="0"
                        Content="Check All" 
                        Height="24" 
                        Margin="0,0,3,0"
                        Click="CheckAllButton_Click"/>
                <Button x:Name="UncheckAllButton" 
                        Grid.Column="1"
                        Content="Uncheck All" 
                        Height="24" 
                        Margin="3,0,3,0"
                        Click="UncheckAllButton_Click"/>
                <Button x:Name="ToggleAllButton" 
                        Grid.Column="2"
                        Content="Toggle All" 
                        Height="24" 
                        Margin="3,0,0,0"
                        Click="ToggleAllButton_Click"/>
            </Grid>

            <!-- Select Button -->
            <Button x:Name="SelectButton" 
                    Content="Select" 
                    Height="32" 
                    Margin="0,10,0,0"
                    IsDefault="True"
                    Click="SelectButton_Click"/>
        </StackPanel>

        <!-- Main Content: Sheet List -->
        <ListView x:Name="SheetsListView" 
                  Margin="0,0,0,0"
                  ItemsSource="{Binding FilteredSheetItems}"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                  VirtualizingStackPanel.IsVirtualizing="True"
                  VirtualizingStackPanel.VirtualizationMode="Standard"
                  ScrollViewer.CanContentScroll="True">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <CheckBox Grid.Column="0"
                                  IsChecked="{Binding IsSelected}" 
                                  VerticalAlignment="Center"
                                  Margin="0,0,10,0"/>
                        <TextBlock Grid.Column="1"
                                   Text="{Binding DisplayName}"
                                   VerticalAlignment="Center"
                                   TextWrapping="NoWrap"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </DockPanel>
</Window>
